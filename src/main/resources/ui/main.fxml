<?xml version="1.0" encoding="UTF-8"?>

<?import com.luciferc137.cmp.ui.*?>
<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<?import javafx.scene.image.ImageView?>
<?import javafx.scene.image.Image?>
<BorderPane xmlns="http://javafx.com/javafx/17.0.12" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.luciferc137.cmp.ui.MainController">

    <top>
        <VBox spacing="5">
            <padding>
                <Insets bottom="5" left="10" right="10" top="10" />
            </padding>

            <!-- Top bar: Song info on left, controls in center, volume on right -->
            <HBox alignment="CENTER" spacing="20">
                <!-- Current song info with cover art (left) -->
                <HBox alignment="CENTER_LEFT" spacing="10" minWidth="300" maxWidth="300">
                    <!-- Cover art -->
                    <ImageView fx:id="currentCoverArt" fitWidth="100" fitHeight="100" smooth="false"/>
                    <!-- Song info -->
                    <VBox alignment="CENTER_LEFT">
                        <Label fx:id="currentTitleLabel" style="-fx-font-size: 14px; -fx-font-weight: bold;" styleClass="song-title"/>
                        <Label fx:id="currentArtistLabel" style="-fx-font-size: 12px;" styleClass="song-artist"/>
                    </VBox>
                </HBox>

                <!-- Playback controls (center) -->
                <VBox alignment="CENTER" spacing="3" HBox.hgrow="ALWAYS">
                    <!-- Main control buttons -->
                    <HBox alignment="CENTER" spacing="10">
                        <Button fx:id="prevButton" onAction="#onPrevious" prefWidth="40" style="-fx-font-size: 16px;" text="â®" />
                        <Button fx:id="stopButton" onAction="#onStop" prefWidth="40" style="-fx-font-size: 16px;" text="â– " />
                        <Button fx:id="playButton" onAction="#onPlay" prefWidth="40" style="-fx-font-size: 16px;" text="â–¶" />
                        <Button fx:id="pauseButton" onAction="#onPause" prefWidth="40" style="-fx-font-size: 16px;" text="â¸" />
                        <Button fx:id="nextButton" onAction="#onNext" prefWidth="40" style="-fx-font-size: 16px;" text="â­" />
                    </HBox>
                    <!-- Secondary controls: shuffle and loop -->
                    <HBox alignment="CENTER" spacing="15">
                        <Button fx:id="shuffleButton" onAction="#onShuffle" prefWidth="60" prefHeight="24" style="-fx-font-size: 11px;" text="Shuf" />
                        <Button fx:id="loopButton" onAction="#onToggleLoop" prefWidth="60" prefHeight="24" style="-fx-font-size: 11px;" text="Loop" />
                    </HBox>
                </VBox>
                <!-- Lyrics button -->
                <HBox alignment="CENTER" spacing="10" minWidth="100" maxWidth="100">
                    <Button fx:id="lyricsButton" onAction="#onShowLyrics" prefWidth="69" prefHeight="34"
                            styleClass="lyrics-button">
                        <graphic>
                            <ImageView fitWidth="69" fitHeight="34" preserveRatio="true">
                                <image>
                                    <javafx.scene.image.Image url="@/icons/lyrics.png"/>
                                </image>
                            </ImageView>
                        </graphic>
                    </Button>
                </HBox>
                <!-- Volume control (right) -->
                <HBox alignment="CENTER_RIGHT" spacing="10" minWidth="190" maxWidth="190">
                    <!-- Lyrics button -->
                    <Label style="-fx-font-size: 14px;" text="ðŸ”Š" />
                    <Slider fx:id="volumeSlider" max="100" min="0" prefWidth="100" value="50" />
                    <Label fx:id="volumePercentLabel" style="-fx-font-size: 13px; -fx-text-fill: #E0E0E0; -fx-min-width: 35px; -fx-alignment: CENTER_RIGHT;" text=" 50%" />
                </HBox>
            </HBox>

            <!-- Progress bar with time labels -->
            <HBox alignment="BOTTOM_CENTER" spacing="10">
                <Label fx:id="elapsedTimeLabel" alignment="BOTTOM_LEFT" prefWidth="50" style="-fx-font-size: 11px;" text="0:00" />
                <WaveformProgressBar fx:id="waveformProgressBar" prefHeight="50" HBox.hgrow="ALWAYS" />
                <Label fx:id="totalTimeLabel" alignment="BOTTOM_RIGHT" prefWidth="50" style="-fx-font-size: 11px;" text="0:00" />
            </HBox>
        </VBox>
    </top>

    <center>
        <SplitPane dividerPositions="0.7">
            <!-- Music library table (left) -->
            <TableView fx:id="musicTable" VBox.vgrow="ALWAYS">
                <columns>
                    <TableColumn fx:id="titleColumn" prefWidth="200" text="Title" />
                    <TableColumn fx:id="artistColumn" prefWidth="150" text="Artist" />
                    <TableColumn fx:id="albumColumn" prefWidth="150" text="Album" />
                    <TableColumn fx:id="durationColumn" prefWidth="70" text="â²" />
                    <TableColumn fx:id="tagsColumn" prefWidth="120" text="Tags" />
                    <TableColumn fx:id="ratingColumn" prefWidth="110" text="Rating" />
                </columns>
            </TableView>

            <!-- Playlist panel (right) -->
            <VBox spacing="5" minWidth="200" prefWidth="250">
                <padding>
                    <Insets top="0" right="0" bottom="0" left="5" />
                </padding>

                <!-- Playlist tabs header -->
                <HBox alignment="CENTER_LEFT" spacing="5">
                    <ScrollPane fx:id="playlistTabsScrollPane" hbarPolicy="NEVER" vbarPolicy="NEVER"
                                fitToHeight="true" HBox.hgrow="ALWAYS" style="-fx-background-color: transparent;">
                        <HBox fx:id="playlistTabsContainer" spacing="3" alignment="CENTER_LEFT" />
                    </ScrollPane>
                    <Button fx:id="managePlaylistsButton" onAction="#onManagePlaylists"  text="âš™" prefWidth="40"
                            style="-fx-font-size: 16px;" />
                </HBox>

                <!-- Current playlist name with sync button -->
                <HBox alignment="CENTER" spacing="5" HBox.hgrow="ALWAYS">
                    <Label fx:id="currentPlaylistLabel" alignment="CENTER_LEFT" text="Local" style="-fx-font-weight: bold; -fx-font-size: 13px;" />
                    <Pane HBox.hgrow="ALWAYS" />
                    <Button fx:id="syncScrollButton" alignment="CENTER_RIGHT" text="â†•" prefWidth="24" prefHeight="24"
                            style="-fx-font-size: 12px; -fx-padding: 2;" />
                </HBox>

                <!-- Playlist content -->
                <TableView fx:id="playlistTable" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn fx:id="playlistTitleColumn" prefWidth="410" text="Title" />
                        <TableColumn fx:id="playlistRatingColumn" prefWidth="90" text="Rating" />
                    </columns>
                </TableView>

                <!-- Playlist info -->
                <Label fx:id="playlistInfoLabel" text="0 tracks" style="-fx-font-size: 11px; -fx-text-fill: #666;" />
            </VBox>
        </SplitPane>
    </center>

    <bottom>
        <HBox alignment="CENTER" spacing="20">
            <padding>
                <Insets bottom="10" left="10" right="10" top="10" />
            </padding>

            <!-- Spacer left -->
            <Pane HBox.hgrow="ALWAYS" />

            <!-- Search bar (center) -->
            <HBox alignment="CENTER" spacing="5">
                <TextField fx:id="searchField" onAction="#onSearch" prefWidth="250" promptText="Search..." />
                <Button onAction="#onClearSearch" prefWidth="30" text="âœ•" />
            </HBox>

            <!-- Spacer right -->
            <Pane HBox.hgrow="ALWAYS" />

            <!-- Settings button (right) -->
            <Button onAction="#onSettings" text="âš™ Settings" />
        </HBox>
    </bottom>

</BorderPane>
